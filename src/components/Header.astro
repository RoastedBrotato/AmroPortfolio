---
import ThemeToggle from './ThemeToggle.svelte';

// Get the current URL path to determine active state
const currentPath = Astro.url.pathname;
---
<script>
  const mobileMenu = document.getElementById('mobile-menu');
  const menuButton = document.getElementById('menu-button');
  const closeButton = document.getElementById('close-button');
  const overlay = document.getElementById('menu-overlay');
  
  menuButton?.addEventListener('click', () => {
    mobileMenu?.classList.remove('translate-x-full');
    mobileMenu?.classList.add('translate-x-0');
    overlay?.classList.remove('hidden');
  });
  
  const closeMenu = () => {
    mobileMenu?.classList.add('translate-x-full');
    mobileMenu?.classList.remove('translate-x-0');
    overlay?.classList.add('hidden');
  };
  
  closeButton?.addEventListener('click', closeMenu);
  overlay?.addEventListener('click', closeMenu);
</script>

<!-- Main Layout Container -->
<div class="desktop sidenaved">
  <!-- Overlay -->
  <div id="menu-overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden"></div>

   <!-- Mobile Top Bar -->
   <div class="lg:hidden fixed top-0 left-0 right-0 h-16 bg-nav-light dark:bg-nav-dark z-30 flex items-center justify-between px-4">
    <a href="/" class="text-xl font-bold text-accent hover:opacity-80 transition-opacity">
      Amro Smadi
    </a>
    <button 
      id="menu-button" 
      class="p-2 rounded-md bg-background-light dark:bg-background-dark"
      aria-label="Toggle menu"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
      </svg>
    </button>
  </div>
  <!-- Header/Sidebar -->
  <header 
    id="mobile-menu"
    class="bg-nav-light dark:bg-nav-dark w-full lg:w-64 h-screen fixed top-0 right-0 flex flex-col transform translate-x-full transition-transform duration-300 z-50 lg:translate-x-0 lg:sticky lg:left-0"
  >
    <nav class="flex flex-col h-full py-8 px-6">
      <!-- Close button - visible only on mobile -->
      <button 
        id="close-button"
        class="absolute top-4 right-4 p-2 text-text-light dark:text-text-dark lg:hidden"
        aria-label="Close menu"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>

      <!-- Logo - visible in desktop -->
      <a href="/" class="text-xl lg:text-2xl font-bold mb-8 text-accent hover:opacity-80 transition-opacity hidden lg:block">
        Amro Smadi
      </a>

      <!-- Navigation Links -->
      <ul class="flex-grow space-y-4 mt-8 text-center md:text-left">
        <li>
          <a 
            href="/about-me" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/about-me' ? 'text-accent' : ''}`}
          >
            About Me
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/about-me' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
      <li>
          <a 
            href="/guidelines" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
            Guidelines
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
         <li>
          <a 
            href="/logofolio" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
            Logofolio
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
        <li>
          <a 
            href="/advertising" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
            Advertising
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
         <li>
          <a 
            href="/social-media" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
            Social Media
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
         <li>
          <a 
            href="/webdesign" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
            Webdesign
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
        <li>
          <a 
            href="/video-motion" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
           Video & Motion Graphic
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
        <li>
          <a 
            href="/photography" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
           Photography
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
         <li>
          <a 
            href="/campaigns" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
           Campaigns & Activations
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
            <li>
          <a 
            href="/contact" 
            class={`block py-1 hover:text-accent transition-colors relative group ${currentPath === '/guidelines' ? 'text-accent' : ''}`}
          >
           Contact me
            <span class={`absolute right-0 top-[23%] w-[5px] h-[15px] bg-accent rounded-full transition-opacity ${currentPath === '/guidelines' ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}></span>
          </a>
        </li>
      </ul>

      <!-- Footer Section -->
      <div class="mt-auto">
        <ThemeToggle client:load />
        <div class="mt-4">
          <a 
            href="#" 
            target="_blank" 
            rel="noopener noreferrer" 
            class="block text-sm text-text-light dark:text-text-dark hover:text-accent transition-colors"
          >
            Instagram
          </a>
        </div>
      </div>
    </nav>
  </header>
</div>

<style>
  .desktop.sidenaved {
    display: flex;
    flex-flow: row;
    align-items: flex-start;
    --sidenav-width: 16rem; /* 256px, matching the lg:w-64 class */
    --cover-width: calc(100vw - var(--sidenav-width));
  }

  @media (max-width: 1024px) {
    .desktop.sidenaved {
      display: block;
    }
  }
</style>